# [スキルツリー](https://raw.githubusercontent.com/nuun888/MZ/master/NUUN_SkillTree.js)
# Ver.1.0.3
[ダウンロード](https://raw.githubusercontent.com/nuun888/MZ/master/NUUN_SkillTree.js)
#### 必須、前提プラグイン
[共通処理](https://github.com/nuun888/MZ/blob/master/README/Base.md)  

#### オプション
[スキルツリーステータス画面カスタマイズ](https://raw.githubusercontent.com/nuun888/MZ/master/NUUN_SkillTreeStausWindowEx.js)  
前提スキルウィンドウ  

ツリー型のスキル習得システムを実装します。  

![画像](img/skillTree1.png)    

## 設定
プラグインパラメータのスキルツリー設定でスキルリストの設定を行います。識別名は必ず記入して下さい。  

アクター、クラススキルツリー設定でアクター、職業によって表示されるスキルタイプを指定します。  
スキルツリーID設定はスキルツリー設定のリストIDまたは識別名を指定し表示されるスキルツリータイプを設定してください。  
※プラグインコマンドのスキルツリータイプ追加でスキルツリータイプを追加できます。  

#### スキルツリーリストの設定
スキルツリー設定のスキル設定でスキルを指定します。  
設定したスキルが派生スキルで選択されていない場合は、自動的に起点スキルになります。  
設定したスキルはウィンドウの左側から派生スキルを元に順に位置が算出されます。既に表示されている座標に後から同じ座標に設定されている場合は、右側にずれて表示されます。  
派生スキルの終端スキルは設定しなくても問題ありませんが、座標やコスト等を設定する場合は追加する必要があります。  

#### コストの設定
各スキルコスト(消費数)には評価式が設定可能です。  
各コストの必要ポイント(個数)が1以上の場合はコストウィンドウに必要なコストが表示されます。  
消費数が0の場合は表示されません。  

#### 職業変更時のスキルツリー
現在クラススキルツリー表示をONにしている場合、特定のクラスでのみ有効なスキルツリーは設定できなくなります。  
クラス変更時スキルリセットをONにすることで、職業変更時に変更前の職業で適用されるスキルツリーのスキルが全てリセットされスキルポイントが返還されます。  
なお、別の同じIDのスキルツリーが有効になっている場合はスキルツリーはリセットされません。  

#### その他多設定
アクターのメモ欄  
`<LevelupSkillPoint:[sp]>` レベルアップ時に指定のスキルポイントを得ます。記入がない場合はプラグインパラメータの設定が適用されます。  
`[sp]`:スキルポイント  

`<InitSkillPoint:[sp]>` 初期のスキルポイントを指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[sp]`:スキルポイント  

アイテム、スキルのメモ欄  
`<GainSkillPoint:[sp]>` 指定のスキルポイントを増減させます。  
`[sp]`:スキルポイント  

`<SkillTreeReset>` スキルポイントを全てリセットします。  

スキルのメモ欄  
`<SKillPointCost:[cost]>` 消費するスキルポイントを指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[cost]`:スキルポイント  

`<SkillTreeItemCost:[Id],[num]>` 消費するアイテムを指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[id]`:アイテムID  
`[num]`:消費アイテム個数  

`<SkillTreeItemWeapon:[Id],[num]>` 消費する武器を指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[id]`:武器ID  
`[num]`:消費武器個数  

`<SkillTreeArmorCost:[Id],[num]>` 消費する防具を指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[id]`:防具ID  
`[num]`:消費防具個数  

`<SkillTreeGoldCost:[cost]>` 消費する金額を指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[cost]`:消費金額  

`<SkillTreeVariablesCost:[Id],[num]>` 消費する防具を指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[id]`:ゲーム変数ID  
`[num]`:消費数  


`<SKillTreeImageImdex:[index]>` スプライトシートのインデックス番号を指定します。記入がない場合はプラグインパラメータの設定が適用されます。  
`[index]`:インデックス番号  

敵キャラのメモ欄  
`<DropSkillPoint:[sp], [rate]>` スキルポイントをドロップします。  
`[sp]`:スキルポイント  
`[rate]`:確率  

#### 評価式(全共通)  
`d`:スキルツリーデータ  
`v`:ゲーム変数　v[id]で指定。[]は付ける。  
`s`:スイッチ　s[id]で指定。[]は付ける。  
`count`:スキルの習得回数  
`actor`:ゲームアクター  

#### 取得できるパラメータ
$gameActors  
`nsp`:スキルポイント  
`this.getSkillTreeCount(skillId)`:対象のスキルの習得回数  
`this.isSkillTreeLearned(skillId)`:対象のスキルが習得済みか  

## スキルツリーステータス画面カスタマイズ 
####必須プラグイン
[ステータス項目ベースプラグイン](https://github.com/nuun888/MZ/blob/master/README/NUUN_MenuParamListBase.md)  

スキルツリーステータスウィンドウの表示するアクターステータスをカスタイマイズ、ステータスウィンドウ、スキルツリーウィンドウ、スキルシーン内のいずれかにアクター画像を表示します。  
ダウンロード  
[スキルツリーステータス画面カスタマイズ](https://raw.githubusercontent.com/nuun888/MZ/master/NUUN_SkillTreeStausWindowEx.js)  

## 仕様
横方向のスクロールの機能は実装いたしません。  

## 追加予定
スキルツリーリセット時のアイテム類の返還。  

#### 更新履歴
2025/8/15 Ver.1.0.0  
初版  

## クラス
`Scene_SkillTree` スキルツリーシーン  
`Window_SkillTreeType` スキルツリータイプウィンドウ  
`Window_SkillTree` スキルツリーウィンドウ  
`Window_SkillTreeCost` スキルツリーコストウィンドウ  
`Window_SkillTreeStatus` スキルツリーステータスウィンドウ  
`Window_SkillTreeConfirmation` 習得確認ウィンドウ  

## 更新履歴
2025/8/18 Ver.1.0.3  
消費スキルコストが0の時でもコストを表示する機能を追加。  
レベルアップ時に獲得SPを表示するように修正。  
導入後にスキルポイントを増減させるとえあらーが出る問題を修正。  
戦闘終了時にエラーが出る問題を修正。  
2025/8/17 Ver.1.0.2  
ロードしたデータでスキルツリーでスキルを習得しようとした場合にエラーが出る問題を修正。  
コストに評価式で設定できるように修正。  
習得条件を満たしているにもかかわらず、スキル項目が選択不能状態になる問題を修正。  
2025/8/15 Ver.1.0.1  
スキルツリーステータス画面カスタマイズに関する更新。  
2025/8/14 Ver.1.0.0  
初版  
